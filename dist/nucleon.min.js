var app=function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&'object'==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,'default',{enumerable:!0,value:e}),2&n&&'string'!=typeof e)for(var r in e)t.d(o,r,function(t){return e[t]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=16)}([function(e){var t=function(){this._locations=[]};t.prototype={_locations:null,_escapeNestedQuotes:function(e){for(var t,n='',o=!1,r=0,a=0,i=e.length;a<i;++a)t=e[a],'<'===t&&!1==o&&0==r&&(o=!0),'>'===t&&!0==o&&0==r&&(o=!1),'"'===t&&o&&(++r,1<r&&((0!=r%2||0==r%2&&(' '===e[a+1]||'>'===e[a+1]))&&(r-=2),0<r&&(t='&quot;'))),n+=t;return n},_escapeCodeTags:function(e){var t=/<code[ a-z"'-_=|]*>(?:(?!<code).|[\r\n])*<\/code>/gi,n=e.match(t);if(n)for(var o,r,a=/<code[ a-z"'-_=|]*>((?:(?!<code).|[\r\n])*)<\/code>/i,s=0,i=n.length;s<i;++s)o=n[s].match(a)[1],r=n[s].replace(o,o.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')),e=e.replace(n[s],r);return e},_escapeSelector:function(e){return e.replace(/#([0-9])/g,'#\\3$1 ').replace(/:+((?!not)[^: ]*)/g,'[type="$1"]')},_removeComments:function(e){var t=/<!--[^>]*-->/gi;return e=e.replace(t,''),e},createElement:function(e){e=e.trim(),e=this._removeComments(e),e=this._escapeCodeTags(e),e=this._escapeNestedQuotes(e);var t=null,n=document.createElement('temp');if(n.innerHTML=e,1===n.childNodes.length)t=n.firstChild.cloneNode(!0);else if(1<n.childNodes.length){t=document.createDocumentFragment();for(var o=0,r=n.childNodes.length;o<r;++o)t.appendChild(n.childNodes[o].cloneNode(!0))}return n=null,t},insertElement:function(e,t,n){if(!e.getAttribute('outside-dom')){var o=document.createDocumentFragment();o.appendChild(e),this.insertInPosition(o,t,n)}},insertElements:function(e,t,n){for(var o=document.createDocumentFragment(),r=0,a=e.length;r<a;++r)e[r].getAttribute('outside-dom')||o.appendChild(e[r]);this.insertInPosition(o,t,n)},insertInPosition:function(e,t,n){0<=n&&t.childNodes[n]&&t.childNodes[n].parentNode?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)},putBackElement:function(e){if(null===e.parentNode&&e.getAttribute('outside-dom'))for(var t,n=0,o=this._locations.length;n<o;++n)if(this._locations[n].element===e){t=this._locations[n],t.next&&t.next.parentNode===t.parent?t.parent.insertBefore(e,t.next):t.prev&&t.prev.parentNode===t.parent?t.prev.nextSibling?t.parent.insertBefore(e,t.prev.nextSibling):t.parent.appendChild(t.element):0===t.parent.childNodes.length||t.parent.childNodes.length<t.position?t.parent.appendChild(t.element):t.parent.insertBefore(e,t.parent.childNodes[t.position]),e.removeAttribute('outside-dom'),this._locations.splice(n,1);break}},removeElement:function(e){e&&null!==e.parentNode&&e.parentNode.removeChild(e)},putAsideElement:function(e){e&&null!==e.parentNode&&(this._locations.push({element:e,parent:e.parentNode,position:this.getPosition(e),prev:e.previousSibling,next:e.nextSibling}),this.removeElement(e),e.setAttribute('outside-dom',!0))},getPosition:function(e){if(!e||null===e.parentNode)return null;for(var t=0,n=e;null!==(n=n.previousSibling);)++t;return t},find:function(e,t){var n=[];if(e.match(/^#+[a-z0-9_-]+$/i))n.push(document.getElementById(e.substr(1)));else{t=t||document.documentElement;try{n=[].slice.call(t.querySelectorAll(e))}catch(o){n=[].slice.call(t.querySelectorAll(this._escapeSelector(e)))}}return n.filter(function(e){return null!==e})},first:function(e,t){var n=this.find(e,t);return 0<n.length?n[0]:null},isMatching:function(e,t){var n=!1,o=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.msMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.oMatchesSelector||null;if(o)try{n=o.call(t,e)}catch(r){n=o.call(t,this._escapeSelector(e))}return n},formToObject:function(e){if(!e||'FORM'!==e.nodeName)return{};var t,n,o={};for(t=e.elements.length-1;0<=t;--t)if(''!==e.elements[t].name)switch(e.elements[t].nodeName){case'INPUT':switch(e.elements[t].type){case'text':case'hidden':case'password':case'button':case'reset':case'submit':case'file':o[e.elements[t].name]=e.elements[t].value;break;case'checkbox':case'radio':e.elements[t].checked&&(o[e.elements[t].name]=e.elements[t].value);}break;case'TEXTAREA':o[e.elements[t].name]=e.elements[t].value;break;case'SELECT':switch(e.elements[t].type){case'select-one':o[e.elements[t].name]=e.elements[t].value;break;case'select-multiple':for(n=e.elements[t].options.length-1;0<=n;--n)o[e.elements[t].name]=[],e.elements[t].options[n].selected&&o[e.elements[t].name].push(e.elements[t].options[n].value);}break;case'BUTTON':switch(e.elements[t].type){case'reset':case'submit':case'button':o[e.elements[t].name]=e.elements[t].value;}}return o}},e.exports=new t},function(e,t,n){function o(e,t,n){var o,i;for(o in e)(i=l.getTypeOf(e[o]),e.hasOwnProperty(o)&&'function'!==i)&&function(t){a(e,o,function(e,o,r,a){n.trigger(e,t,r,a)}),r(e,o,t,e[o],i,n)}(t?t+'.'+o:o)}function r(e,t,n,s,d,p){e[t]instanceof i||(d=d||l.getTypeOf(s),'object'===d?(o(e[t],n,p),p.on('change',n,function(r,a){for(var i in o(e[t],n,p),p._callbacks)n!==i&&0===i.indexOf(n)&&p.trigger('change',i,l.getPropertyValue(r,i),l.getPropertyValue(a,i))})):'array'===d&&(e[t]=new i(s,function(e,t,o){p.trigger(e,n,t,o)}),o(e[t],n,p),p.on('change',n,function(r){e[t]instanceof i||(r=r||e[t],delete e[t],e[t]=new i(r,function(e,t,o){p.trigger(e,n,t,o)}),a(e,t,function(e,t,o,r){p.trigger(e,n,o,r)}),o(e[t],n,p))}).on('add',n,function(o){var s;if(o instanceof Array)for(var l=0,i=o.length;l<i;++l)s=e[t].indexOf(o[l]),function(n){a(e[t],s,function(e,t,o,r){p.trigger(e,n,o,r)}),r(e[t],s,n,e[t][s],null,p)}(n?n+'.'+s:s);else s=e[t].indexOf(o),function(n){a(e[t],s,function(e,t,o,r){p.trigger(e,n,o,r)}),r(e[t],s,n,e[t][s],null,p)}(n?n+'.'+s:s)})))}function a(e,t,n){var o=e[t],r=o;l.redefineProperty(e,t,function(){return o},function(e){r=o,o=e,r!==e&&n('change',t,e,r)})}var i=n(3),s=n(9),l=n(4);e.exports=function(e){var t=new s;return l.duplicateProperties(e,this),o(this,null,t),this.on=function(e,n,o){t.on(e,n,o)},this.trigger=function(e,t,n){if('change'===e){var o=l.getPropertyValue(this,t);n!==o&&l.setPropertyValue(this,t,n)}},this}},function(e){var t=function(){return this._routes={},this};t.prototype={_routes:null,register:function(e){var t=e.getName();if(this._routes[t])throw new Error('A route with name "'+t+'" is already registered.');return this._routes[t]=e,this},findRoute:function(e,t){for(var n in this._routes)if(this._routes[n].match(e,t))return this._routes[n];return null},generateUrl:function(e,t,n){if(!this._routes[e])throw new Error('Try to generate an url for a route named "'+e+'" that is not registered.');return this._routes[e].generateUrlWithParams(t,n)}},e.exports=new t},function(e){var t=function(e,t){for(var n=0,o=e.length;n<o;++n)this[n]=e[n];return this.length=e.length,this._handler=t,this},n=Array.prototype,o=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t.push(e[n]);return t},r={pop:'remove',push:'add',reverse:'change',shift:'remove',sort:'change',splice:'remove',unshift:'add'};for(var a in r)(function(e){t.prototype[e]=function(){var t,a=o(this),i=r[e],s=n[e].apply(this,arguments);return'remove'===i||'change'===i?t=s:'add'===i&&(t=arguments[1]?n.slice.call(arguments):arguments[0]),this._handler(i,t,a),'change'!==i&&this._handler('change',this,a),s}})(a);for(var s=['concat','every','filter','forEach','indexOf','join','lastIndexOf','map','reduce','reduceRight','slice','some','toLocaleString','toString'],l=0,i=s.length;l<i;++l)t.prototype[s[l]]=n[s[l]];e.exports=t},function(e){e.exports={setPropertyValue:function(e,t,n){for(var o=t.split('.'),r=0,a=o.length;r<a;++r)r+1<a?e=void 0===e[o[r]]?e[o[r]]={}:e[o[r]]:e[o[r]]=n;return e},getPropertyValue:function(e,t){for(var n=t.split('.'),o=0,r=n.length;o<r&&(e=e[n[o]],void 0!==e);++o);return e},removeProperty:function(e,t){for(var n=t.split('.'),o=0,r=n.length;o<r;++o)if(!(o<r-1))delete e[n[o]];else if(e=e[n[o]],void 0===e)break},duplicateProperties:function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},getTypeOf:function(e){return Object.prototype.toString.call(e).replace('[object ','').replace(']','').toLowerCase()},redefineProperty:function(e,t,n,o){'function'==typeof Object.prototype.defineProperty?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:o}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,o))}}},function(e,t,n){e.exports=function(e,t){var o=n(15),r=document.createElement('a');return r.href=e,o.delegate({preventDefault:function(){},target:r},t)}},function(e,t,n){var o=n(7),r=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A view with the name "'+t+'" is already defined.');return e[t]=new o(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No view with the name "'+t+'" could be found.');return e[t]},this.render=function(t,n){if(void 0===e[t])throw new Error('No view with the name "'+t+'" could be found.');if(!0!==n){var o,r=e[t]._getRoot();for(var a in e)a!==t&&(o=e[a],o.isRendered()&&o._getRoot()===r&&o.revoke())}e[t].render()},this.revoke=function(t){if(void 0===e[t])throw new Error('No view with the name "'+t+'" could be found.');e[t].revoke()}};e.exports=r},function(e,t,n){var o=n(12),r=n(0),a=n(22),i=n(1),s=n(2),l=n(6),d=function(e){return this._buildConfig(e),this};d.prototype={_root:null,_template:null,_templateUrl:null,_context:null,_parent:null,_components:null,_onRender:null,_onRendered:null,_onUpdate:null,_onUpdated:null,_onRevoke:null,_onRevoked:null,_elements:[],_position:null,_fusioner:null,_rendered:!1,_childsRoot:null,_childsPosition:null,_buildConfig:function(e){for(var t in e){if('components'==t){for(var n in this._components={},e[t])this._components[n.toLowerCase()]=e[t][n];continue}null===this['_'+t]?this['_'+t]=e[t]:this[t]=e[t]}this._context=this._buildContext(this._context||{})},_buildContext:function(e){if(e instanceof i)return e;var t,n={};for(t in e)!1==e[t]instanceof i&&(n[t]=e[t],delete e[t]);for(t in n=new i(n),e)n[t]=e[t];return n.generateUrl=function(e,t,n){return s.generateUrl(e,t,n)},n},_getRoot:function(){if(this._parent&&!this._root)this._root=this._parent._getRoot();else if('string'==typeof this._root){var e=r.first(this._root);if(!e)throw new Error('Root element with selector "'+this._root+'" could not been found.');this._root=e}return this._root},_prepareElements:function(){if(!this._elements.length){var e=this;if(!this._template&&this._templateUrl?o.get(this._templateUrl,{t_ref:new Date().getTime()},{async:!1,success:function(t){e._template=t},error:function(){throw new Error('Template located in "'+e._templateUrl+'" could not be loaded.')}}):!this._template&&!this._templateUrl&&(this._elements=[this._getRoot()]),'string'==typeof this._template&&!this._elements.length){var t=r.createElement(this._template);if(t instanceof HTMLElement)this._elements=[t];else if(t instanceof DocumentFragment)for(this._elements=[];t.firstChild;)this._elements.push(t.removeChild(t.firstChild))}this._parent&&(this._root=this._parent._childsRoot,this._position=this._parent._childsPosition)}},_buildFusioner:function(){if(!this._fusioner){var e=this,t={elements:this._elements,context:this._context,components:this._components,view:this,shouldApply:function(){return e._rendered}};'function'==typeof e._onUpdate&&(t.onUpdate=function(){e._onUpdate()}),'function'==typeof e._onUpdated&&(t.onUpdated=function(){e._onUpdated()}),this._fusioner=new a(t)}},_mount:function(){this._prepareElements(),this._buildFusioner()},render:function(e){var t=this;if(this._parent){if('string'==typeof this._parent)this._parent=l.get(this._parent);else if(!(this._parent instanceof d))throw new Error('View parent must be either another view name or instance.');if(!this._parent.isRendered())return this._parent.render(function(){t.render(e)})}if(this._mount(),!this._rendered){'function'==typeof this._onRender&&this._onRender();var n=this._getRoot();this._elements[0]===n?r.putBackElement(n):r.insertElements(this._elements,n,this._position),this._rendered=!0,'function'==typeof this._onRendered&&this._onRendered(),this._fusioner.applyChanges()}'function'==typeof e&&e()},revoke:function(){if(this._rendered){'function'==typeof this._onRevoke&&this._onRevoke();var e=this._getRoot();if(this._elements[0]!==e)for(var t=0,n=this._elements.length;t<n;++t)r.removeElement(this._elements[t]);else r.putAsideElement(e);this._rendered=!1,'function'==typeof this._onRevoked&&this._onRevoked()}},getContext:function(){return this._context},isRendered:function(){return this._rendered},getChildsRoot:function(){return this._childsRoot},clone:function(e){this._prepareElements(),e=e||{},e.root=e.root||this._root,e.template=e.template||this._template,e.templateUrl=e.templateUrl||this._templateUrl,e.elements=[];for(var t=0,n=this._elements.length;t<n;++t)e.elements.push(this._elements[t].cloneNode(!0));return e.parent=e.parent||this._parent,e.onRender=e.onRender||this.onRender,e.onRendered=e.onRendered||this._onRendered,e.onUpdate=e.onUpdate||this._onUpdate,e.onUpdated=e.onUpdated||this._onUpdated,e.onRevoke=e.onRevoke||this._onRevoke,e.onRevoked=e.onRevoked||this._onRevoked,e.context=e.context||{},new d(e)}},e.exports=d},function(e,t,n){var o=n(9),r=new o;e.exports={on:function(e,t){r.on(e,'app',t)},off:function(e,t){r.off(e,'app',t)},trigger:function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(e,'app'),!1!==r.trigger.apply(r,t)}}},function(e){var t=function(){return this._callbacks={},this};t.prototype={_callbacks:null,_extractEvents:function(e){return e.split(',').map(function(e){return e.trim()})},on:function(e,t,n){this._callbacks[t]=this._callbacks[t]||{};for(var o=this._extractEvents(e),r=0,a=o.length;r<a;++r)this._callbacks[t][o[r]]=this._callbacks[t][o[r]]||[],-1===this._callbacks[t][o[r]].indexOf(n)&&this._callbacks[t][o[r]].push(n);return this},off:function(e,t,n){if(this._callbacks[t])for(var o=this._extractEvents(e),r=0,a=o.length;r<a;++r)if(this._callbacks[t][o[r]]){var i=this._callbacks[t][o[r]].indexOf(n);-1!==i&&this._callbacks[t][o[r]].splice(i,1)}return this},trigger:function(e,t){if(this._callbacks[t])for(var n,o,r=this._extractEvents(e),a=Array.prototype.slice.call(arguments,2),s=0,i=r.length;s<i;++s)if(this._callbacks[t][r[s]])for(n=0,o=this._callbacks[t][r[s]].length;n<o&&!1!==this._callbacks[t][r[s]][n].apply(this,a);++n);return this},clear:function(){return this._callbacks={},this}},e.exports=t},function(e,t,n){var o=n(11),r=new o;e.exports=r},function(e,t,n){var o=n(0),r=function(){return this._listeners=[],this};r.prototype={_listeners:null,_extractEvents:function(e){return e.split(',').map(function(e){return e.trim()})},_findTarget:function(e,t,n){if(this._listeners[e])for(var o=0,r=this._listeners[e].length;o<r;++o)if(t===this._listeners[e][o].selector&&n===this._listeners[e][o].callback)return this._listeners[e][o];return null},_findTargets:function(e,t){for(var n=[],r=0,a=this._listeners[e].length;r<a;++r)o.isMatching(this._listeners[e][r].selector,t)&&n.push(this._listeners[e][r]);return n},_addTarget:function(e,t,n){this._listeners[e]||(this._listeners[e]=[]),this._findTarget(e,t,n)||this._listeners[e].push({selector:t,callback:n})},_removeTarget:function(e,t,n){var o=this._findTarget(e,t,n);o&&this._listeners[e].splice(this._listeners[e].indexOf(o),1)},_addListener:function(e,t,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent('on'+e,function(){return n.call(window.event.srcElement,window.event)});else throw new Error('Given element can not have a listener.')},_removeListener:function(e,t,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent('on'+e,function(){return n.call(window.event.srcElement,window.event)})},_createEvent:function(e,t){var n;return document.createEvent?(n=document.createEvent('HTMLEvents'),n.initEvent(e,!0,!0)):(n=document.createEventObject(),n.eventType=e),n.eventName=e,n.target=t,n},_dispatchEvent:function(e,t){'string'==typeof e&&(e=this._createEvent(e,t)),document.createEvent?t.dispatchEvent(e):t.fireEvent('on'+e.eventType,e)},_createDelegatedEvent:function(t){if(!this._listeners[t.type])return t;for(var e,n=t.target||t.srcElement,r=0,a=this._listeners[t.type].length;r<a;++r){for(e=n;e&&!1===o.isMatching(this._listeners[t.type][r].selector,e);)e=e.parentNode&&document!==e.parentNode?e.parentNode:null;if(e)break}if(!e)return t;var i={};for(var s in t)i[s]=t[s];return i.returnValue=null,i.preventDefault=function(){t.preventDefault?t.preventDefault():t.returnValue=!1,this.returnValue=!1},i.target=i.srcElement=e,i},_delegate:function(t){if(this._listeners[t.type])for(var e=this._createDelegatedEvent(t),n=this._findTargets(e.type,e.target),o=0,r=n.length;o<r;++o)if(n[o].callback.call(e.target,e),!1===e.returnValue)return},on:function(e,t,n){e=this._extractEvents(e);for(var o=0,r=e.length;o<r;++o)if('string'==typeof t){if(!this._listeners[e[o]]){var a=this;this._addListener(e[o],document,function(t){a._delegate(t)})}this._addTarget(e[o],t,n)}else this._addListener(e[o],t,n);return this},off:function(e,t,n){e=this._extractEvents(e);for(var o=0,r=e.length;o<r;++o)'string'==typeof t?this._removeTarget(e[o],t,n):this._removeListener(e[o],t,n);return this},trigger:function(e,t){e=this._extractEvents(e);for(var n='string'==typeof t,r=n?o.find(t):null,a=0,i=e.length;a<i;++a)if(n)for(var s=0,l=r.length;s<l;++s)this._dispatchEvent(e[a],r[s]);else this._dispatchEvent(e[a],t);return this},clear:function(){for(var e in this._listeners)this._listeners[e]=[];return this}},e.exports=r},function(e){var t=function(){return this._cache={},this};t.prototype={_cache:null,_buildConfig:function(e,t,n,o){return o=o||{},o.method=t,o.url=e,o.data=n,o},_initConfig:function(e){if(!e.url)throw new Error('No url provided.');if(e.method=e.method||'GET',-1===['GET','POST','PUT','DELETE'].indexOf(e.method))throw new Error('Only methods GET, PUT, POST, DELETE are allowed.');if('GET'===e.method&&e.data){var t=[];for(var n in e.data)t.push(encodeURIComponent(n)+'='+encodeURIComponent(e.data[n]));t=t.join('&'),e.url+=(-1===e.url.indexOf('?')?'?':'&')+t,e.data=null}else if('POST'===e.method||'PUT'===e.method)if('JSON'===e.dataType)e.data=JSON.stringify(e.data);else{var o=new FormData;for(var r in e.data)o.append(r,e.data[r]);e.data=o}return e.format=e.format||null,e.headers=e.headers||{},e.async=!1!==e.async,e.cors=!0===e.cors,e.cache=!0===e.cache,e.success=e.success||function(){},e.error=e.error||function(){},e.always=e.always||function(){},e.progress=e.progress||function(){},e.timeout=e.timeout||function(){},e},_buildPublicApi:function(e,t){return{success:function(t){return e.success=t,this},error:function(t){return e.error=t,this},always:function(t){return e.always=t,this},abort:function(){return t.abort(),this}}},_handleError:function(e,t,n){e.error&&(e.error.call(e,n,t.status),e.error=null,e.always.call(e))},_handleResponse:function(e,t){var n=this._parseResponse(e,t.responseText);return 200<=t.status&&400>t.status?(e.cache&&'GET'===e.method&&(this._cache[e.url]=t.responseText),e.success.call(e,n,t.status),e.always.call(e)):this._handleError(e,t,n),n},_parseResponse:function(e,t){return'JSON'===e.format?JSON.parse(t):t},call:function(e){e=this._initConfig(e);var t,n=this;if('GET'===e.method&&this._cache[e.url]&&!1!==e.cache)return t={responseText:this._cache[e.url],status:200},e.async?(setTimeout(function(){n._handleResponse(e,t)},1),this._buildPublicApi(e,t)):this._handleResponse(e,t);if(t=new(XMLHttpRequest||ActiveXObject)('MSXML2.XMLHTTP.3.0'),e.cors)if('withCredentials'in t);else if('undefined'==typeof XDomainRequest)t=new XDomainRequest;else throw new Error('Your browser does not support CORS request.');if(t.open(e.method,e.url,e.async),t.setRequestHeader)for(var o in t.setRequestHeader('X-Requested-With','XMLHttpRequest'),('POST'===e.method||'PUT'===e.method)&&'JSON'===e.dataType&&t.setRequestHeader('Content-Type','application/json'),e.headers)t.setRequestHeader(o,e.headers[o]);return e.async?(t.onprogress&&e.onprogress&&(t.onprogress=function(){if(t.lengthComputable){var n=t.loaded/t.total;e.progress(n)}}),t.ontimeout&&e.ontimeout&&(t.ontimeout=e.timeout),t.onreadystatechange=function(){3<t.readyState&&n._handleResponse(e,t)},t.onerror=function(){n._handleResponse(e,t)},setTimeout(function(){t.send(e.data)},0),this._buildPublicApi(e,t)):(t.send(e.data),this._handleResponse(e,t))},get:function(e,t,n){return this.call(this._buildConfig(e,'GET',t,n))},post:function(e,t,n){return this.call(this._buildConfig(e,'POST',t,n))},put:function(e,t,n){return this.call(this._buildConfig(e,'PUT',t,n))},delete:function(e,t,n){return this.call(this._buildConfig(e,'DELETE',t,n))}},e.exports=new t},function(e,t,n){var o=n(19),r=n(2),a=n(20),i=n(6),s=n(7),l=function(e){return this._build(e)};l.prototype={_fn:null,_name:null,_route:null,_view:null,_build:function(e){if(!e.name)throw new Error('Page "'+e.name+'" must have a name.');if(this._name=e.name,!e.fn&&!e.view)throw new Error('Page "'+e.name+'" must have a function or a view.');if(e.fn&&'function'!=typeof e.fn)throw new Error('"fn" declared in page "'+e.name+'" is not a function.');if(this._fn=e.fn||function(){this.renderView()},!e.route)throw new Error('Page "'+e.name+'" must have a route.');return'string'==typeof e.route&&(e.route={path:e.route,method:'GET'}),e.route.scheme=e.name,e.route.name=e.route.name?e.route.name:e.name,this._route=new o(e.route),r.register(this._route),e.view&&(!(e.view instanceof s)&&(e.view=i.add(this._name+'_view',e.view)),this._view=e.view),this},getViewContext:function(){if(!this._view)throw new Error(this._name+' page has no inner view. getViewContext() can not be called.');return this._view._context},renderView:function(e){if(!this._view)throw new Error(this._name+' page has no inner view. renderView() can not be called.');i.render(this._name+'_view',e)},run:function(e,t){if(!1!==t){var n=this;a.addEntry(e.getUrl(),function(){n._fn.call(n,e)})}this._fn.call(this,e)}},e.exports=l},function(e,t,n){var o=n(11),r=new o;e.exports=r},function(e,t,n){var o=n(13),r=n(21),a=n(14),i=n(2),s=n(5),l=n(8),d=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A page with the name "'+t+'" is already defined.');return n.name=t,e[t]=new o(n),this},this.get=function(t){if(void 0===e[t])throw new Error('No page with the name "'+t+'" could be found.');return e[t]},this.delegate=function(t,n){if(t){var o=t.target;if(!o.getAttribute('data-no-follow')){var a=o.tagName.toUpperCase(),s='FORM'===a?o.action:o.href;if(/#$/.test(s))return void t.preventDefault();var d='FORM'===a?o.method.toUpperCase():'GET',p=i.findRoute(s,d);if(!p)return void l.trigger('route.not_found',new r({event:t}));var _=new r({event:t,route:p});if(!1!==l.trigger('route.found',_)){var c=e[p.getScheme()];if(c)return!1===l.trigger('page.pre_run',_)?void 0:(t.preventDefault(),n=void 0===n,c.run(_,n),l.trigger('page.post_run',_),!1)}}}},a.on('click','[href]',this.delegate).on('submit','form',this.delegate).on('load',window,function(){s(window.location.href,!1)})};e.exports=d},function(e,t,n){e.exports={channel:n(8),Collection:n(3),events:n(10),http:n(12),memory:n(17),Model:n(1),models:n(18),Page:n(13),pages:n(15),View:n(7),views:n(6),redirect:n(5),router:n(2)}},function(e,t,n){var o=n(4),r=function(){this._storage=window.localStorage||window.globalStorage||{},this._root=this._storage[this._namespace]?JSON.parse(this._storage[this._namespace]):{}};r.prototype={_storage:{},_root:{},_namespace:'nucleon_app',_save:function(){var e=this;setTimeout(function(){e._storage[e._namespace]=JSON.stringify(e._root)},0)},set:function(e,t){return o.setPropertyValue(this._root,e,t),this._save(),this},get:function(e){return o.getPropertyValue(this._root,e)},all:function(){return this._root},remove:function(e){return o.removeProperty(this._root,e),this._save(),this},clear:function(){return this._root={},this._save(),this}},e.exports=new r},function(e,t,n){var o=n(1),r=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A model with the name "'+t+'" is already defined.');return e[t]=new o(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No model with the name "'+t+'" could be found.');return e[t]}};e.exports=r},function(e){var t=function(e){return this._params={},this._build(e)};t.prototype={_path:null,_pattern:null,_params:null,_method:null,_name:null,_scheme:null,_build:function(e){if(this._setMethod(e.method||'GET'),e.params&&this._setParams(e.params),e.path)this._setPath(e.path);else throw new Error('Path must be defined.');if(e.name)this._name=e.name;else throw new Error('Name must be defined.');return e.scheme&&(this._scheme=e.scheme),this},_setMethod:function(e){if(e=e.toUpperCase(),'GET'!==e&&'POST'!==e&&'GET|POST'!==e&&'POST|GET'!==e)throw new Error('Method is not supported. "GET", "POST", "GET|POST" only.');return this._method=new RegExp(e),this},_setParams:function(e){if(!1==e instanceof Object)throw new Error('Params must be an object.');for(var t in e)'number'===e[t]?e[t]='[0-9]+':'word'===e[t]?e[t]='[a-zA-Z0-9%]+':'slug'===e[t]&&(e[t]='[a-zA-Z0-9_-]+');return this._params=e,this},_setPath:function(e){return this._path=e,this._setPattern(e),this},_setPattern:function(e){this._pattern=e;var t;for(var n in this._params){if(t='{'+n+'}',-1===this._pattern.indexOf(t))throw new Error('Parameter "'+n+'" is not in route path "'+e+'".');this._pattern=this._pattern.replace(t,this._params[n])}return-1===this._pattern.indexOf(window.location.host)&&(this._pattern=window.location.host+this._pattern),this._pattern+='$',this._pattern=new RegExp(this._pattern),this},match:function(e,t){return e=e.split('?')[0],this._pattern.test(e)&&this._method.test(t)},extractParamsFromUrl:function(e){var t,n,o,r={};for(var a in this._params){for(n in t=this._path,this._params)t=t.replace('{'+n+'}',a===n?'('+this._params[n]+')':this._params[n]);(o=new RegExp(t).exec(e))&&(r[a]=decodeURI(o[1]))}return r},generateUrlWithParams:function(e,t){var n,o=this._path,r=[];for(var a in e)if(n='{'+a+'}',-1===o.indexOf(n))r.push(encodeURI(a)+'='+encodeURI(e[a]));else if(new RegExp(this._params[a]).test(e[a]))o=o.replace(n,e[a]);else throw new Error('Invalid parameter "'+a+'" for route path "'+this._path+'". Must match "'+this._params[a]+'".');return 0<r.length&&(o+=(-1===o.indexOf('?')?'?':'&')+r.join('&')),!0===t&&(o=window.location.protocol+'//'+window.location.host+o),o},getName:function(){return this._name},getScheme:function(){return this._scheme}},e.exports=t},function(e,t,n){var o=n(14),r=n(5),a=function(){this._callbacks=[];var e=this;o.on('load',window,function(){setTimeout(function(){o.on('popstate',window,function(){return e._index=window.history.state?window.history.state.index:-1,!(-1===e._index&&e._loadEntry(e._index))&&void 0===r(window.location.href,!1)&&void window.location.replace(window.location.href)})},1)})};a.prototype={_index:-1,_callbacks:null,_updateUrl:function(e){window.history.pushState({index:this.index},'',e)},_loadEntry:function(e){return!!this._callbacks[e]&&(this._callbacks[e](),!0)},addEntry:function(e,t){window.history.pushState&&(this._index++,this._callbacks.length-1>this._index&&this._callbacks.splice(this._index,this._callbacks.length-this._index),this._callbacks[this._index]=t,this._updateUrl(e))}},e.exports=new a},function(e,t,n){var o=n(0),r=function(e){return this._components={},this._query={},this._post={},this._build(e)};r.prototype={_event:null,_protocol:null,_host:null,_port:null,_path:null,_url:null,_method:null,_hash:null,_components:null,_query:null,_post:null,_build:function(e){this._event=e.event;var t=document.createElement('a');return t.href=e.event.target.action||e.event.target.href,this._protocol=t.protocol.replace(':',''),this._host=t.hostname,this._port=parseInt(e.port),isNaN(this._port)&&(this._port=parseInt(window.location.port.replace(':')),isNaN(this._port)&&(this._port='https:'===window.location.protocol?443:80)),this._path=t.pathname.replace('//','/'),this._url=t.href,this._method=(e.event.target.method||'GET').toUpperCase(),this._hash=t.hash,e.route&&(this._components=e.route.extractParamsFromUrl(t.href)),t.search&&(this._query=JSON.parse('{"'+decodeURI(t.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')),'FORM'===e.event.target.tagName.toUpperCase()&&'POST'===this._method&&(this._post=o.formToObject(e.event.target)),this},getEvent:function(){return this._event},getProtocol:function(){return this._protocol},getHost:function(){return this._host},getPath:function(){return this._path},getUrl:function(){return this._url},getPort:function(){return this._port},getMethod:function(){return this._method},getHash:function(){return this._hash},getUriComponents:function(){return this._components},getQueryParams:function(){return this._query},getPostParams:function(){return this._post}},e.exports=r},function(e,t,n){var o=n(4),r=n(0),a=n(10),s=n(23),l=n(1),d=n(3),i=/\{\{((?!\{\{|\}\}).)*\}\}/g,p=/\{\{|\}\}/g,_=/[ |(|)|{|}|[|]|,|:|\+|"|']/g,c=function(e){this._init=[],this._waiting=[],this._events={},!1==e.elements instanceof Array&&(e.elements=[e.elements]),this._elements=e.elements,this._context=e.context,this._view=e.view,this._components=e.components,this._shouldApply=e.shouldApply,this._onUpdate=e.onUpdate,this._onUpdated=e.onUpdated;for(var t=this._elements.length-1;0<=t;--t)this._bind(this._elements[t]);return this};c.prototype={_elements:null,_context:null,_shouldApply:null,_onUpdate:null,_onUpdated:null,_init:null,_waiting:null,_events:null,_view:null,_extractMarkers:function(e){if(e){var t=e.match(i);if(t&&0<t.length)return t=t.map(function(e){return{outer:e,inner:e.replace(p,'').trim()}}),0<t.length?t:[]}return[]},_extractContextProperties:function(e){for(var t,n,o=[],r=e.split(_),a=0,i=r.length;a<i;++a)r[a]&&(t=r[a].split('.'),n=t.shift(),void 0!==this._context[n]&&(!1==this._context[n]instanceof l&&(t.unshift(n),n=null),o.push({model:n,path:t.join('.').replace('.length','')})));return o},_replaceAliases:function(e,t){if(t)for(var n in t)if(n===e)e=t[n];else{e=e.replace(new RegExp('([(|)|,|+|-|*|/])?(\\b'+n+'\\b)+([(|)|,|+|-|*|/])?','g'),function(e,o,r,a){return(o?o:'')+t[n]+(a?a:'')})}return e},_replaceAliasesInElement:function(e,t){if(1===e.nodeType){var n;for(n=e.attributes.length-1;0<=n;--n)e.setAttribute(e.attributes[n].name,this._replaceAliases(e.attributes[n].value,t));for(n=e.childNodes.length-1;0<=n;--n)this._replaceAliasesInElement(e.childNodes[n],t)}else if(3===e.nodeType){var o=e.textContent?'textContent':'nodeValue';e[o]=this._replaceAliases(e[o],t)}return e},_evaluateText:function(e){var t=s.process(e,this._context);return t||0===t?t:''},_getPropPath:function(e){return(e.model?e.model+(e.path?'.':''):'')+e.path},_on:function(e,t,n){var o=this._getPropPath(t),r=o+':'+e;if(!this._events[r]){this._events[r]=[];var a=t.model?this._context[t.model]:this._context,i=this;a.on(e,t.path,function(n){i._dispatch(e,t,n)})}this._events[r].push(n)},_trigger:function(e,t,n){var o=t.model?this._context[t.model]:this._context;o.trigger(e,t.path,n)},_dispatch:function(e,t,n){var o=this._getPropPath(t)+':'+e;if(0<this._events[o].length){var r,a;if(!1!==this._shouldApply()){for('function'==typeof this._onUpdate&&this._onUpdate(),r=0,a=this._events[o].length;r<a;++r)this._events[o][r](n);'function'==typeof this._onUpdated&&this._onUpdated()}else for(r=0,a=this._events[o].length;r<a;++r)-1===this._waiting.indexOf(this._events[o][r])&&this._waiting.push(this._events[o][r])}},_createComponent:function(e,t,n,a,d){var p,_=this,c={},u=n.getContext();for(p in u)'on'!==p&&'trigger'!==p&&(c[p]=u[p]);for(var m,h,g=e.attributes.length-1;0<=g;--g)(p=e.attributes[g].name,0!==p.indexOf('data-'))&&(m=m||{},m[p]=this._replaceAliases(e.attributes[g].value,t),c[p]=s.process(m[p],this._context));c=new l(c);var i=a||e.parentNode||this._view._getRoot();d=d||r.getPosition(e);var f=n.clone({context:c,root:i,position:d});if(f._mount(),m)for(p in m)this._extractContextProperties(m[p]+'').forEach(function(e){(function(t){f._fusioner._on('change',f._fusioner._extractContextProperties(t)[0],function(e){e=e||o.getPropertyValue(f._context,t),o.setPropertyValue(_._context,m[t],e)}),_._on('change',e,function(e){e=e||o.getPropertyValue(_._context,m[t]),o.setPropertyValue(c,t,e)})})(p)});if(e.hasAttribute('data-if')){h=this._replaceAliases(e.getAttribute('data-if'),t);var v=function(){var e=s.process(h,_._context);void 0===e||!1===e||null===e||''===e?f.revoke():f.render()};v(),this._extractContextProperties(h).forEach(function(e){'function'!=typeof o.getPropertyValue(_._context,_._getPropPath(e))&&_._on('change',e,v)})}else f.render();return f},_removeElement:function(e){if(e.parentNode)r.removeElement(e);else{var t=this._elements.indexOf(e);-1!==t&&this._elements.splice(t,1)}},_bind:function(e,t){if(e){if(1===e.nodeType){if(e.hasAttribute('data-no-bind'))return;var n=e.tagName.toLowerCase();return'child-views'===n?(this._view._childsRoot=e.parentNode||this._view._getRoot(),this._view._childsPosition=r.getPosition(e),void this._removeElement(e)):this._components&&this._components[n]?this._bindComponent(e,t,n):this._bindElement(e,t,n)}return 3===e.nodeType?this._bindTextNode(e,t):e}},_bindElement:function(t,e,n){var l,p,_,c,u,i,m=this;if(t.hasAttribute('data-for')){l=t.getAttribute('data-for'),e=e||{};var h=l.replace(/in .*/,'').trim(),g=null;-1!==h.indexOf(',')&&(h=h.split(','),g=h[0].trim(),h=h[1].trim());var f=this._replaceAliases(l.replace(/.* in/,'').trim(),e),v=this._extractContextProperties(f);_=v.length?this._getPropPath(v[0]):null;var x=t.parentNode||this._view._getRoot(),b=r.getPosition(t);this._removeElement(t),t.removeAttribute('data-for');var y=s.process(f,this._context);if(!1===this._isIterable(y))throw new Error(f+' is an invalid expression for a loop.');var P=[];if(y instanceof d){var E=function(n){var a,i;if(n=n||o.getPropertyValue(m._context,_),n.length>P.length){var s,l=[];for(a=P.length,i=n.length;a<i;++a)e[h]=_+'.'+a,g&&(e[g]=a+''),s=t.cloneNode(!0),P.push(s),l.push(s),m._bind(m._replaceAliasesInElement(s,e),e);r.insertElements(l,x,b+(P.length-l.length))}else if(n.length<P.length)for(a=P.length,i=n.length;a>=i;--a)r.removeElement(P[a]),P.splice(a,1)};E(y),this._on('change',v[0],E)}else if(y instanceof Object){var w=function(n){for(var a=P.length-1;0<=a;--a)r.removeElement(P[a]),P.splice(a,1);n=n||o.getPropertyValue(m._context,_);var i;for(var s in y)n.hasOwnProperty(s)&&'function'!=typeof n[s]&&(g?(e[g]='"'+s+'"',e[h]=_+'.'+s):e[h]='"'+s+'"',i=t.cloneNode(!0),m._bind(m._replaceAliasesInElement(i,e),e),P.push(i));r.insertElements(P,x,b)};w(y),v.length&&this._on('change',v[0],w)}else if('number'==typeof y){var T=0,k=function(n){if(n=n||s.process(f,m._context),n!==T){var o,a,i,l=[];if(n>T){for(o=T;o<n;++o)i=t.cloneNode(!0),l.push(i),P.push(i);for(r.insertElements(l,x,b),o=0,a=l.length;o<a;++o)e[h]=T+o+'',m._bind(m._replaceAliasesInElement(l[o],e),e)}else for(o=T;o>=n;--o)r.removeElement(P[o]),P.splice(o,1);T=n}};if(0<v.length)for(u=0,i=v.length;u<i;++u)this._on('change',v[u],function(){k()});k(y)}return}if(t.hasAttribute('data-bind')){if(l=t.getAttribute('data-bind'),p=this._extractContextProperties(l),0===p.length)throw new Error('Data-bind with value "'+l+'" refers to a non existing context property.');p=p[0],_=this._getPropPath(p);var N;'select'===n||'input'===n&&('radio'===t.type||'checkbox'===t.type)?(N=function(e){e=e||o.getPropertyValue(m._context,_),'radio'===t.type||'checkbox'===t.type?!0===e||e===t.value?t.checked='checked':t.checked='':t.value=e},m._init.push(function(){N(o.getPropertyValue(m._context,_))}),this._on('change',p,N),a.on('change',t,function(n){var e=n.target||n.srcElement,o=e.value;('radio'===t.type||'checkbox'===t.type)&&('checkbox'===e.type&&'on'===o?o=!!e.checked:o=e.checked?o:null),m._trigger('change',p,o)})):('textarea'==n||'input'==n)&&(N=function(e){e=e||o.getPropertyValue(m._context,_),t.value=null===e?'':e},N(o.getPropertyValue(this._context,_)),this._on('change',p,N),c='oninput'in t?'input':'keyup, keypress',a.on(c,t,function(t){var e=t.target||t.srcElement;m._trigger('change',p,e.value)})),t.removeAttribute('data-bind')}if(t.hasAttribute('data-events')){var C,R,A=t.getAttribute('data-events').split(';');for(u=0,i=A.length;u<i;++u)C=A[u].split(':'),2===C.length&&(c=C[0].trim(),R=C[1].trim(),a.on(c,t,function(t){m._context.e=t,s.process(R,m._context)}));t.removeAttribute('data-events')}if(t.hasAttribute('data-if')&&(function(e){var n=function(){var n=s.process(e,m._context);void 0===n||!1===n||null===n||''===n?r.putAsideElement(t):r.putBackElement(t)};t.parentNode?n():m._init.push(n),m._extractContextProperties(e).forEach(function(e){'function'!=typeof o.getPropertyValue(m._context,m._getPropPath(e))&&m._on('change',e,n)})}(t.getAttribute('data-if')),t.removeAttribute('data-if')),t.hasAttribute('data-show')&&(function(e){var n=function(){var n=s.process(e,m._context);t.style.display=void 0===n||!1===n||null===n||''===n?'none':''};n(),m._extractContextProperties(e).forEach(function(e){'function'!=typeof o.getPropertyValue(m._context,m._getPropPath(e))&&m._on('change',e,n)})}(t.getAttribute('data-show')),t.removeAttribute('data-show')),t.attributes){var U,O,S;for(u=0,i=t.attributes.length;u<i;++u)U=t.attributes[u].name,O=t.attributes[u].value,O&&(S=m._extractMarkers(O),0<S.length&&function(e,n,r){var a=function(){for(var o=n,a=0,i=r.length;a<i;++a)o=o.replace(r[a].outer,m._evaluateText(r[a].inner));t.setAttribute(e,o)};a(),r.forEach(function(e){m._extractContextProperties(e.inner).forEach(function(e){'function'!=typeof o.getPropertyValue(m._context,m._getPropPath(e))&&m._on('change',e,a)})})}(U,O,S))}for(u=t.childNodes.length-1;0<=u;--u)this._bind(t.childNodes[u],e)},_bindTextNode:function(e,t){var n=e.textContent?'textContent':'nodeValue',r=e[n].trim();if(r){r=this._replaceAliases(r,t);var a=this._extractMarkers(r);if(0<a.length){var s=this,l=function(){for(var t=r,o=0,i=a.length;o<i;++o)t=t.replace(a[o].outer,s._evaluateText(a[o].inner));e[n]=t};l();for(var d=0,i=a.length;d<i;++d)this._extractContextProperties(a[d].inner).forEach(function(e){'function'!=typeof o.getPropertyValue(s._context,s._getPropPath(e))&&s._on('change',e,l)})}}},_bindComponent:function(e,t,n){var r=this,a=e.parentNode||this._view._getRoot();if(this._removeElement(e),e.hasAttribute('data-for')){t=t||{};var l=e.getAttribute('data-for'),p=l.replace(/in .*/,'').trim(),_=null;-1!==p.indexOf(',')&&(p=p.split(','),_=p[0].trim(),p=p[1].trim());var c=this._replaceAliases(l.replace(/.* in/,'').trim(),t),u=s.process(c,this._context);if(!1===this._isIterable(u))throw new Error(c+' is an invalid expression for a loop.');var m=this._extractContextProperties(c),h=m.length?this._getPropPath(m[0]):null,g=[];if(u instanceof d){var f=function(s){s=s||o.getPropertyValue(r._context,h);var l,i;if(s.length>g.length)for(l=g.length,i=s.length;l<i;++l)t[p]=h+'.'+l,_&&(t[_]=l+''),g.push(r._createComponent(e,t,r._components[n],a));else for(l=g.length-1,i=s.length-1;l>i;--l)g[l].revoke(),g.splice(l,1)[0]=null};f(u),this._on('change',m[0],f)}else if(u instanceof Object){var v=function(s){for(var l=g.length-1;0<=l;--l)g[l].revoke(),g.splice(l,1)[0]=null;for(var i in s=s||o.getPropertyValue(r._context,h),u)s.hasOwnProperty(i)&&'function'!=typeof s[i]&&(_?(t[_]='"'+i+'"',t[p]=h+'.'+i):t[p]='"'+i+'"',g.push(r._createComponent(e,t,r._components[n],a)))};v(u),m.length&&this._on('change',m[0],v)}else if('number'==typeof u){var x=function(o){o=o||s.process(c,r._context);var l;if(o>g.length)for(l=g.length;l<o;++l)t[p]=l+'',g.push(r._createComponent(e,t,r._components[n],a));else if(o<g.length)for(l=g.length-1;l>o;--l)g[l].revoke(),g.splice(l,1)[0]=null};if(x(u),1===m.length)this._on('change',m[0],x);else if(1<m.length)for(var b=m.length-1;0<=b;--b)this._on('change',m[b],function(){x()})}return}this._createComponent(e,t,this._components[n],a)},_isIterable:function(e){return!0==e instanceof d||!0==e instanceof Object||'number'==typeof e},applyChanges:function(){var e,t;if(0<this._init.length){for(e=0,t=this._init.length;e<t;++e)this._init[e]();this._init=[]}if(0<this._waiting.length){for('function'==typeof this._onUpdate&&this._onUpdate(),e=0,t=this._waiting.length;e<t;++e)this._waiting[e]();this._waiting=[],'function'==typeof this._onUpdated&&this._onUpdated()}}},e.exports=c},function(e){e.exports=new function(){'use strict';var e,t,n,o,r,a,s,l,d,p,_,c,i=',',u={"!":function(e,t){return!t[e+1]},"*":function(e,t){return t[e-1]*t[e+1]},"/":function(e,t){return t[e-1]/t[e+1]},"%":function(e,t){return t[e-1]%t[e+1]},"-":function(e,t){return(t[e-1]||0)-t[e+1]},"+":function(e,t){var n=void 0===t[e-1]?0:t[e-1];null===n&&(n='');var o=void 0===t[e+1]?0:t[e+1];return null===o&&(o=''),n+o},"!=":function(e,t){return t[e-1]!==t[e+1]},"==":function(e,t){return t[e-1]===t[e+1]},">":function(e,t){return t[e-1]>t[e+1]},">=":function(e,t){return t[e-1]>=t[e+1]},"<":function(e,t){return t[e-1]<t[e+1]},"<=":function(e,t){return t[e-1]<=t[e+1]},"&&":function(e,t){return t[e-1]&&t[e+1]},"||":function(e,t){return t[e-1]||t[e+1]},"?":function(e,t){var n=':'===t[e+1]?'':t[e+1],o=void 0===t[e+3]?':'===t[e+2]?'':t[e+2]:t[e+3];return t[e-1]?n:o}};this.process=function(m,h,g){function f(e){return!0!==e}function v(e){c.push(e)}function x(){return c.pop()}function b(){return n||o}function y(e){return /^[a-z.]+\(/i.test(e)}function P(e){return void 0!==u[e]}function E(n){p&&(e++,t[e]='',p=!1),t[e]+=n}function w(e){T(),E(e)}function T(){''!==t[e]&&(p=!0),!0===_&&(t[e]=C(t[e]),_=!1)}function N(e,t){var n=e.split('.');if(!h||void 0===h[n[0]])return g?void 0:e;var o,r=h,a=r,i=n.length;for(o=0;o<i;++o)if(void 0!==r[n[o]])a=r,r=r[n[o]];else return g?void 0:e;return'function'==typeof r&&(r=r.apply(a,t)),r}function C(e){return'undefined'===e?void 0:'null'===e?null:'false'!=e&&('true'==e||(isNaN(e)?N(e):parseFloat(e)))}function R(n,o){t.splice(o,1);var r=t[n].substring(0,t[n].length-1),a=t.splice(n+1,o);O(a);var s=a.filter(function(e){return e!==i});t[n]=N(r,s),e=n}function A(n,o){var r=t.splice(n+1,o-n-1);O(r),t.splice(n,2,r[0]),e=n}function U(n,o){for(var r=n;r<o;++r)'{'!==t[r]&&':'!==t[r]&&'}'!==t[r]&&','!==t[r]&&'['!==t[r]&&']'!==t[r]&&(isNaN(parseFloat(t[r]))||!isFinite(t[r]))&&(t[r]='"'+t[r]+'"');var a=t.splice(n,o-n+1),i=JSON.parse(a.join(''));t[n]=i,e=n}function O(n){n=n||t;var o,r,a,i,s;for(i in u)if(void 0!==d[i])for(;-1<(s=n.indexOf(i));)'?'===i?(o=s-1,r=5):'!'===i?(o=s,r=2):(o=0<=s-1?s-1:s,r=e===o?2:3),a=u[i](s,n),n.splice(o,r,a)}g=void 0===g||g,e=0,t=[''],n=!1,o=!1,r=!1,a=!1,s=0,l=0,d={},p=!1,_=!1,c=[];var S,V,k=m.length;for(S=0;S<k;++S)switch(V=m[S],V){case'"':if(!n&&!r){o=f(o),(!o||a)&&T();continue}_=!1,E(V);break;case'\'':if(!o&&!r){n=f(n),(!n||a)&&T();continue}_=!1,E(V);break;case'\\':if(r=f(r),r)continue;E(V);break;default:if(b())E(V);else switch(V){case' ':T();break;case i:case':':w(V),T();break;case'[':w(V),T(),0===l+s&&v(e),++l;break;case']':w(V),T(),--l,0===l+s&&U(x(),e);break;case'{':w(V),T(),0===l+s&&v(e),++s;break;case'}':w(V),T(),--s,0===l+s&&U(x(),e);break;case'(':y(t[e]+V)?_=!1:T(),E(V),T(),v(e);break;case')':w(V),T();var M=x();y(t[M])?R(M,e):A(M,e);break;default:P(t[e]+V)?(a=!0,_=!1,d[t[e]+V]=!0):P(V)?(!a&&T(),a=!0,_=!1,d[V]=!0):a?(T(),a=!1,_=!0,d[t[e]]=!0):_=!0,E(V);}}if(_&&(t[e]=C(t[e])),O(t),1<t.length)throw new Error('Invalid expression "'+m+'".');return t[0]}}}]);