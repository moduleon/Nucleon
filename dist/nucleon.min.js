var app=function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&'object'==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,'default',{enumerable:!0,value:e}),2&n&&'string'!=typeof e)for(var r in e)t.d(a,r,function(t){return e[t]}.bind(null,r));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=14)}([function(e){var t=function(){this._locations=[]};t.prototype={_locations:null,_escapeNestedQuotes:function(e){for(var t,n='',a=!1,r=0,o=0,i=e.length;o<i;++o)t=e[o],'<'===t&&!1==a&&0==r&&(a=!0),'>'===t&&!0==a&&0==r&&(a=!1),'"'===t&&a&&(++r,1<r&&((0!=r%2||0==r%2&&(' '===e[o+1]||'>'===e[o+1]))&&(r-=2),0<r&&(t='&quot;'))),n+=t;return n},_escapeCodeTags:function(e){var t=/<code[ a-z"'-_=|]*>(?:(?!<code).|[\r\n])*<\/code>/gi,n=e.match(t);if(n)for(var a,r,o=/<code[ a-z"'-_=|]*>((?:(?!<code).|[\r\n])*)<\/code>/i,l=0,i=n.length;l<i;++l)a=n[l].match(o)[1],r=n[l].replace(a,a.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')),e=e.replace(n[l],r);return e},_escapeSelector:function(e){return e.replace(/#([0-9])/g,'#\\3$1 ').replace(/:+((?!not)[^: ]*)/g,'[type="$1"]')},_removeComments:function(e){var t=/<!--[^>]*-->/gi;return e=e.replace(t,''),e},createElement:function(e){e=e.trim(),e=this._removeComments(e),e=this._escapeCodeTags(e),e=this._escapeNestedQuotes(e);var t=null,n=document.createElement('temp');if(n.innerHTML=e,1===n.childNodes.length)t=n.firstChild.cloneNode(!0);else if(1<n.childNodes.length){t=document.createDocumentFragment();for(var a=0,r=n.childNodes.length;a<r;++a)t.appendChild(n.childNodes[a].cloneNode(!0))}return n=null,t},insertElement:function(e,t,n){if(!e.getAttribute('outside-dom')){var a=document.createDocumentFragment();a.appendChild(e),this.insertInPosition(a,t,n)}},insertElements:function(e,t,n){for(var a=document.createDocumentFragment(),r=0,o=e.length;r<o;++r)e[r].getAttribute('outside-dom')||a.appendChild(e[r]);this.insertInPosition(a,t,n)},insertInPosition:function(e,t,n){0<=n&&t.childNodes[n]&&t.childNodes[n].parentNode?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)},putBackElement:function(e){if(null===e.parentNode&&e.getAttribute('outside-dom'))for(var t,n=0,a=this._locations.length;n<a;++n)if(this._locations[n].element===e){t=this._locations[n],t.next&&t.next.parentNode===t.parent?t.parent.insertBefore(e,t.next):t.prev&&t.prev.parentNode===t.parent?t.prev.nextSibling?t.parent.insertBefore(e,t.prev.nextSibling):t.parent.appendChild(t.element):0===t.parent.childNodes.length||t.parent.childNodes.length<t.position?t.parent.appendChild(t.element):t.parent.insertBefore(e,t.parent.childNodes[t.position]),e.removeAttribute('outside-dom'),this._locations.splice(n,1);break}},removeElement:function(e){e&&null!==e.parentNode&&e.parentNode.removeChild(e)},putAsideElement:function(e){e&&null!==e.parentNode&&(this._locations.push({element:e,parent:e.parentNode,position:this.getPosition(e),prev:e.previousSibling,next:e.nextSibling}),this.removeElement(e),e.setAttribute('outside-dom',!0))},getPosition:function(e){if(!e||null===e.parentNode)return null;for(var t=0,n=e;null!==(n=n.previousSibling);)++t;return t},find:function(e,t){var n=[];if(e.match(/^#+[a-z0-9_-]+$/i))n.push(document.getElementById(e.substr(1)));else{t=t||document.documentElement;try{n=[].slice.call(t.querySelectorAll(e))}catch(a){n=[].slice.call(t.querySelectorAll(this._escapeSelector(e)))}}return n.filter(function(e){return null!==e})},first:function(e,t){var n=this.find(e,t);return 0<n.length?n[0]:null},isMatching:function(e,t){var n=!1,a=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.msMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.oMatchesSelector||null;if(a)try{n=a.call(t,e)}catch(r){n=a.call(t,this._escapeSelector(e))}return n},formToObject:function(e){if(!e||'FORM'!==e.nodeName)return{};var t,n,a={};for(t=e.elements.length-1;0<=t;--t)if(''!==e.elements[t].name)switch(e.elements[t].nodeName){case'INPUT':switch(e.elements[t].type){case'text':case'hidden':case'password':case'button':case'reset':case'submit':case'file':a[e.elements[t].name]=e.elements[t].value;break;case'checkbox':case'radio':e.elements[t].checked&&(a[e.elements[t].name]=e.elements[t].value);}break;case'TEXTAREA':a[e.elements[t].name]=e.elements[t].value;break;case'SELECT':switch(e.elements[t].type){case'select-one':a[e.elements[t].name]=e.elements[t].value;break;case'select-multiple':for(n=e.elements[t].options.length-1;0<=n;--n)a[e.elements[t].name]=[],e.elements[t].options[n].selected&&a[e.elements[t].name].push(e.elements[t].options[n].value);}break;case'BUTTON':switch(e.elements[t].type){case'reset':case'submit':case'button':a[e.elements[t].name]=e.elements[t].value;}}return a}},e.exports=new t},function(e){var t=function(){return this._routes={},this};t.prototype={_routes:null,register:function(e){var t=e.getName();if(this._routes[t])throw new Error('A route with name "'+t+'" is already registered.');return this._routes[t]=e,this},findRoute:function(e,t){for(var n in this._routes)if(this._routes[n].match(e,t))return this._routes[n];return null},generateUrl:function(e,t,n){if(!this._routes[e])throw new Error('Try to generate an url for a route named "'+e+'" that is not registered.');return this._routes[e].generateUrlWithParams(t,n)}},e.exports=new t},function(e){e.exports={setPropertyValue:function(e,t,n){for(var a=t.split('.'),r=0,o=a.length;r<o;++r)r+1<o?e=void 0===e[a[r]]?e[a[r]]={}:e[a[r]]:e[a[r]]=n;return e},getPropertyValue:function(e,t){for(var n=t.split('.'),a=0,r=n.length;a<r&&(e=e[n[a]],void 0!==e);++a);return e},removeProperty:function(e,t){for(var n=t.split('.'),a=0,r=n.length;a<r;++a)if(!(a<r-1))delete e[n[a]];else if(e=e[n[a]],void 0===e)break},duplicateProperties:function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},getTypeOf:function(e){return Object.prototype.toString.call(e).replace('[object ','').replace(']','').toLowerCase()},redefineProperty:function(e,t,n,a){'function'==typeof Object.prototype.defineProperty?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:a}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,a))}}},function(e,t,n){function a(e,t,n){var a,i;for(a in e)(i=s.getTypeOf(e[a]),e.hasOwnProperty(a)&&'function'!==i)&&function(t){o(e,a,function(e,a,r,o){n.trigger(e,t,r,o)}),r(e,a,t,e[a],i,n)}(t?t+'.'+a:a)}function r(e,t,n,l,d,p){e[t]instanceof i||(d=d||s.getTypeOf(l),'object'===d?(a(e[t],n,p),p.on('change',n,function(){for(var r in a(e[t],n,p),p._callbacks)n!==r&&-1!==r.indexOf(n)&&p.trigger('change',r,s.getPropertyValue(e[t],r))})):'array'===d&&(e[t]=new i(l,function(e,t){p.trigger(e,n,t)}),a(e[t],n,p),p.on('change',n,function(r){e[t]instanceof i||(r=r||e[t],delete e[t],e[t]=new i(r,function(e,t){p.trigger(e,n,t)}),o(e,t,function(e,t,a,r){p.trigger(e,n,a,r)}),a(e[t],n,p))}).on('add',n,function(a){var l;if(a instanceof Array)for(var s=0,i=a.length;s<i;++s)l=e[t].indexOf(a[s]),function(n){o(e[t],l,function(e,t,a,r){p.trigger(e,n,a,r)}),r(e[t],l,n,e[t][l],null,p)}(n?n+'.'+l:l);else l=e[t].indexOf(a),function(n){o(e[t],l,function(e,t,a,r){p.trigger(e,n,a,r)}),r(e[t],l,n,e[t][l],null,p)}(n?n+'.'+l:l)})))}function o(e,t,n){var a=e[t],r=a;s.redefineProperty(e,t,function(){return a},function(e){r=a,a=e,r!==e&&n('change',t,e,r)})}var i=n(10),l=n(6),s=n(2);e.exports=function(e){var t=new l;return s.duplicateProperties(e,this),a(this,null,t),this.on=function(e,n,a){t.on(e,n,a)},this.trigger=function(e,t,n){if('change'===e){var a=s.getPropertyValue(this,t);n!==a&&s.setPropertyValue(this,t,n)}},this}},function(e,t,n){e.exports=function(e,t){var a=n(11),r=document.createElement('a');return r.href=e,a.delegate({preventDefault:function(){},target:r},t)}},function(e,t,n){var a=n(6),r=new a;e.exports={on:function(e,t){r.on(e,'app',t)},off:function(e,t){r.off(e,'app',t)},trigger:function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(e,'app'),!1!==r.trigger.apply(r,t)}}},function(e){var t=function(){return this._callbacks={},this};t.prototype={_callbacks:null,on:function(e,t,n){return this._callbacks[t]=this._callbacks[t]||{},this._callbacks[t][e]=this._callbacks[t][e]||[],-1===this._callbacks[t][e].indexOf(n)&&this._callbacks[t][e].push(n),this},off:function(e,t,n){if(this._callbacks[t]&&this._callbacks[t][e]){var a=this._callbacks[t][e].indexOf(n);return-1!==a&&this._callbacks[t][e].splice(a,1),this}},trigger:function(e,t){if(this._callbacks[t]&&this._callbacks[t][e]){for(var n=0,a=this._callbacks[t][e].length;n<a;++n)if(!1===this._callbacks[t][e][n].apply(this,Array.prototype.slice.call(arguments,2)))return!1;return this}},clear:function(){return this._callbacks={},this}},e.exports=t},function(e,t,n){var a=n(8),r=new a;e.exports=r},function(e,t,n){var a=n(0),r=function(){return this._listeners=[],this};r.prototype={_listeners:null,_extractEvents:function(e){return e.split(',').map(function(e){return e.trim()})},_findTarget:function(e,t,n){if(this._listeners[e])for(var a=0,r=this._listeners[e].length;a<r;++a)if(t===this._listeners[e][a].selector&&n===this._listeners[e][a].callback)return this._listeners[e][a];return null},_findTargets:function(e,t){for(var n=[],r=0,o=this._listeners[e].length;r<o;++r)a.isMatching(this._listeners[e][r].selector,t)&&n.push(this._listeners[e][r]);return n},_addTarget:function(e,t,n){this._listeners[e]||(this._listeners[e]=[]),this._findTarget(e,t,n)||this._listeners[e].push({selector:t,callback:n})},_removeTarget:function(e,t,n){var a=this._findTarget(e,t,n);a&&this._listeners[e].splice(this._listeners[e].indexOf(a),1)},_addListener:function(e,t,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent('on'+e,function(){return n.call(window.event.srcElement,window.event)});else throw new Error('Given element can not have a listener.')},_removeListener:function(e,t,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent('on'+e,function(){return n.call(window.event.srcElement,window.event)})},_createEvent:function(e,t){var n;return document.createEvent?(n=document.createEvent('HTMLEvents'),n.initEvent(e,!0,!0)):(n=document.createEventObject(),n.eventType=e),n.eventName=e,n.target=t,n},_dispatchEvent:function(e,t){'string'==typeof e&&(e=this._createEvent(e,t)),document.createEvent?t.dispatchEvent(e):t.fireEvent('on'+e.eventType,e)},_createDelegatedEvent:function(t){if(!this._listeners[t.type])return t;for(var e,n=t.target||t.srcElement,r=0,o=this._listeners[t.type].length;r<o;++r){for(e=n;e&&!1===a.isMatching(this._listeners[t.type][r].selector,e);)e=e.parentNode&&document!==e.parentNode?e.parentNode:null;if(e)break}if(!e)return t;var i={};for(var l in t)i[l]=t[l];return i.returnValue=null,i.preventDefault=function(){t.preventDefault?t.preventDefault():t.returnValue=!1,this.returnValue=!1},i.target=i.srcElement=e,i},_delegate:function(t){if(this._listeners[t.type])for(var e=this._createDelegatedEvent(t),n=this._findTargets(e.type,e.target),a=0,r=n.length;a<r;++a)if(n[a].callback.call(e.target,e),!1===e.returnValue)return},on:function(e,t,n){e=this._extractEvents(e);for(var a=0,r=e.length;a<r;++a)if('string'==typeof t){if(!this._listeners[e[a]]){var o=this;this._addListener(e[a],document,function(t){o._delegate(t)})}this._addTarget(e[a],t,n)}else this._addListener(e[a],t,n);return this},off:function(e,t,n){e=this._extractEvents(e);for(var a=0,r=e.length;a<r;++a)'string'==typeof t?this._removeTarget(e[a],t,n):this._removeListener(e[a],t,n);return this},trigger:function(e,t){e=this._extractEvents(e);for(var n='string'==typeof t,r=n?a.find(t):null,o=0,i=e.length;o<i;++o)if(n)for(var l=0,s=r.length;l<s;++l)this._dispatchEvent(e[o],r[l]);else this._dispatchEvent(e[o],t);return this},clear:function(){for(var e in this._listeners)this._listeners[e]=[];return this}},e.exports=r},function(e){var t=function(){return this._cache={},this};t.prototype={_cache:null,_buildConfig:function(e,t,n,a){return a=a||{},a.method=t,a.url=e,a.data=n,a},_initConfig:function(e){if(!e.url)throw new Error('No url provided.');if(e.method=e.method||'GET',-1===['GET','POST','PUT','DELETE'].indexOf(e.method))throw new Error('Only methods GET, PUT, POST, DELETE are allowed.');if('GET'===e.method&&e.data){var t=[];for(var n in e.data)t.push(encodeURIComponent(n)+'='+encodeURIComponent(e.data[n]));t=t.join('&'),e.url+=(-1===e.url.indexOf('?')?'?':'&')+t,e.data=null}else if('POST'===e.method||'PUT'===e.method)if('JSON'===e.dataType)e.data=JSON.stringify(e.data);else{var a=new FormData;for(var r in e.data)a.append(r,e.data[r]);e.data=a}return e.format=e.format||null,e.headers=e.headers||{},e.async=!1!==e.async,e.cors=!0===e.cors,e.cache=!0===e.cache,e.success=e.success||function(){},e.error=e.error||function(){},e.always=e.always||function(){},e.progress=e.progress||function(){},e.timeout=e.timeout||function(){},e},_buildPublicApi:function(e,t){return{success:function(t){return e.success=t,this},error:function(t){return e.error=t,this},always:function(t){return e.always=t,this},abort:function(){return t.abort(),this}}},_handleError:function(e,t,n){e.error&&(e.error.call(e,n,t.status),e.error=null,e.always.call(e))},_handleResponse:function(e,t){var n=this._parseResponse(e,t.responseText);return 200<=t.status&&400>t.status?(e.cache&&'GET'===e.method&&(this._cache[e.url]=t.responseText),e.success.call(e,n,t.status),e.always.call(e)):this._handleError(e,t,n),n},_parseResponse:function(e,t){return'JSON'===e.format?JSON.parse(t):t},call:function(e){e=this._initConfig(e);var t,n=this;if('GET'===e.method&&this._cache[e.url]&&!1!==e.cache)return t={responseText:this._cache[e.url],status:200},e.async?(setTimeout(function(){n._handleResponse(e,t)},1),this._buildPublicApi(e,t)):this._handleResponse(e,t);if(t=new(XMLHttpRequest||ActiveXObject)('MSXML2.XMLHTTP.3.0'),e.cors)if('withCredentials'in t);else if('undefined'==typeof XDomainRequest)t=new XDomainRequest;else throw new Error('Your browser does not support CORS request.');if(t.open(e.method,e.url,e.async),t.setRequestHeader)for(var a in t.setRequestHeader('X-Requested-With','XMLHttpRequest'),('POST'===e.method||'PUT'===e.method)&&'JSON'===e.dataType&&t.setRequestHeader('Content-Type','application/json'),e.headers)t.setRequestHeader(a,e.headers[a]);return e.async?(t.onprogress&&e.onprogress&&(t.onprogress=function(){if(t.lengthComputable){var n=t.loaded/t.total;e.progress(n)}}),t.ontimeout&&e.ontimeout&&(t.ontimeout=e.timeout),t.onreadystatechange=function(){3<t.readyState&&n._handleResponse(e,t)},t.onerror=function(){n._handleResponse(e,t)},setTimeout(function(){t.send(e.data)},0),this._buildPublicApi(e,t)):(t.send(e.data),this._handleResponse(e,t))},get:function(e,t,n){return this.call(this._buildConfig(e,'GET',t,n))},post:function(e,t,n){return this.call(this._buildConfig(e,'POST',t,n))},put:function(e,t,n){return this.call(this._buildConfig(e,'PUT',t,n))},delete:function(e,t,n){return this.call(this._buildConfig(e,'DELETE',t,n))}},e.exports=new t},function(e){var t=function(e,t){for(var n=0,a=e.length;n<a;++n)this[n]=e[n];return this.length=e.length,this._handler=t,this},n=Array.prototype,a={pop:'remove',push:'add',reverse:'change',shift:'remove',sort:'change',splice:'remove',unshift:'add'};for(var r in a)(function(e){t.prototype[e]=function(){var t,r=a[e],o=n[e].apply(this,arguments);return'remove'===r||'change'===r?t=o:'add'===r&&(t=arguments[1]?n.slice.call(arguments):arguments[0]),this._handler(r,t),o}})(r);for(var o=['concat','every','filter','forEach','indexOf','join','lastIndexOf','map','reduce','reduceRight','slice','some','toLocaleString','toString'],l=0,i=o.length;l<i;++l)t.prototype[o[l]]=n[o[l]];e.exports=t},function(e,t,n){var a=n(17),r=n(23),o=n(12),i=n(1),l=n(4),s=n(5),d=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A page with the name "'+t+'" is already defined.');return n.name=t,e[t]=new a(n),this},this.get=function(t){if(void 0===e[t])throw new Error('No page with the name "'+t+'" could be found.');return e[t]},this.delegate=function(t,n){if(t){var a=t.target;if(!a.getAttribute('data-no-follow')){var o=a.tagName.toUpperCase(),l='FORM'===o?a.action:a.href;if(/#$/.test(l))return void t.preventDefault();var d='FORM'===o?a.method.toUpperCase():'GET',p=i.findRoute(l,d);if(!p)return void s.trigger('route.not_found',new r({event:t}));var c=new r({event:t,route:p});if(!1!==s.trigger('route.found',c)){var _=e[p.getScheme()];if(_)return!1===s.trigger('page.pre_run',c)?void 0:(t.preventDefault(),n=void 0===n,_.run(c,n),s.trigger('page.post_run',c),!1)}}}},o.on('click','[href]',this.delegate).on('submit','form',this.delegate).on('load',window,function(){l(window.location.href,!1)})};e.exports=d},function(e,t,n){var a=n(8),r=new a;e.exports=r},function(e,t,n){var a=n(20),r=new function(){var e={},t=null;this.add=function(t,n){if(void 0!==e[t])throw new Error('A view with the name "'+t+'" is already defined.');return e[t]=new a(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No view with the name "'+t+'" could be found.');return e[t]},this.render=function(n,a){if(void 0===e[n])throw new Error('No view with the name "'+n+'" could be found.');!0!==a&&(t&&t!==e[n]&&t.revoke(),t=e[n]),e[n].render()},this.revoke=function(n){if(void 0===e[n])throw new Error('No view with the name "'+n+'" could be found.');t===e[n]&&(t=void 0),e[n].revoke()}};e.exports=r},function(e,t,n){e.exports={channel:n(5),events:n(7),http:n(9),memory:n(15),models:n(16),pages:n(11),views:n(13),redirect:n(4),router:n(1)}},function(e,t,n){var a=n(2),r=function(){this._storage=window.localStorage||window.globalStorage||{},this._root=this._storage[this._namespace]?JSON.parse(this._storage[this._namespace]):{}};r.prototype={_storage:{},_root:{},_namespace:'nucleon_app',_save:function(){var e=this;setTimeout(function(){e._storage[e._namespace]=JSON.stringify(e._root)},0)},set:function(e,t){return a.setPropertyValue(this._root,e,t),this._save(),this},get:function(e){return a.getPropertyValue(this._root,e)},all:function(){return this._root},remove:function(e){return a.removeProperty(this._root,e),this._save(),this},clear:function(){return this._root={},this._save(),this}},e.exports=new r},function(e,t,n){var a=n(3),r=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A model with the name "'+t+'" is already defined.');return e[t]=new a(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No model with the name "'+t+'" could be found.');return e[t]}};e.exports=r},function(e,t,n){var a=n(18),r=n(1),o=n(19),i=n(13),l=function(e){return this._build(e)};l.prototype={_fn:null,_name:null,_route:null,_view:null,_build:function(e){if(!e.name)throw new Error('Page "'+e.name+'" must have a name.');if(this._name=e.name,!e.fn)throw new Error('Page "'+e.name+'" must have a function.');if('function'!=typeof e.fn)throw new Error('"fn" declared in page "'+e.name+'" is not a function.');if(this._fn=e.fn,!e.route)throw new Error('Page "'+e.name+'" must have a route.');return'string'==typeof e.route&&(e.route={path:e.route,method:'GET'}),e.route.scheme=e.name,e.route.name=e.route.name?e.route.name:e.name,this._route=new a(e.route),r.register(this._route),e.view&&(this._view=i.add(this._name+'_view',e.view)),this},getViewContext:function(){if(!this._view)throw new Error(this._name+' page has no inner view. getViewContext() can not be called.');return this._view._context},renderView:function(e){if(!this._view)throw new Error(this._name+' page has no inner view. renderView() can not be called.');i.render(this._name+'_view',e)},run:function(e,t){if(!1!==t){var n=this;o.addEntry(e.getUrl(),function(){n._fn.call(n,e)})}this._fn.call(this,e)}},e.exports=l},function(e){var t=function(e){return this._params={},this._build(e)};t.prototype={_path:null,_pattern:null,_params:null,_method:null,_name:null,_scheme:null,_build:function(e){if(this._setMethod(e.method||'GET'),e.params&&this._setParams(e.params),e.path)this._setPath(e.path);else throw new Error('Path must be defined.');if(e.name)this._name=e.name;else throw new Error('Name must be defined.');return e.scheme&&(this._scheme=e.scheme),this},_setMethod:function(e){if(e=e.toUpperCase(),'GET'!==e&&'POST'!==e&&'GET|POST'!==e&&'POST|GET'!==e)throw new Error('Method is not supported. "GET", "POST", "GET|POST" only.');return this._method=new RegExp(e),this},_setParams:function(e){if(!1==e instanceof Object)throw new Error('Params must be an object.');for(var t in e)'number'===e[t]?e[t]='[0-9]+':'word'===e[t]?e[t]='[a-zA-Z0-9%]+':'slug'===e[t]&&(e[t]='[a-zA-Z0-9_-]+');return this._params=e,this},_setPath:function(e){return this._path=e,this._setPattern(e),this},_setPattern:function(e){this._pattern=e;var t;for(var n in this._params){if(t='{'+n+'}',-1===this._pattern.indexOf(t))throw new Error('Parameter "'+n+'" is not in route path "'+e+'".');this._pattern=this._pattern.replace(t,this._params[n])}return-1===this._pattern.indexOf(window.location.host)&&(this._pattern=window.location.host+this._pattern),this._pattern+='$',this._pattern=new RegExp(this._pattern),this},match:function(e,t){return e=e.split('?')[0],this._pattern.test(e)&&this._method.test(t)},extractParamsFromUrl:function(e){var t,n,a,r={};for(var o in this._params){for(n in t=this._path,this._params)t=t.replace('{'+n+'}',o===n?'('+this._params[n]+')':this._params[n]);(a=new RegExp(t).exec(e))&&(r[o]=decodeURI(a[1]))}return r},generateUrlWithParams:function(e,t){var n,a=this._path,r=[];for(var o in e)if(n='{'+o+'}',-1===a.indexOf(n))r.push(encodeURI(o)+'='+encodeURI(e[o]));else if(new RegExp(this._params[o]).test(e[o]))a=a.replace(n,e[o]);else throw new Error('Invalid parameter "'+o+'" for route path "'+this._path+'". Must match "'+this._params[o]+'".');return 0<r.length&&(a+=(-1===a.indexOf('?')?'?':'&')+r.join('&')),!0===t&&(a=window.location.protocol+'//'+window.location.host+a),a},getName:function(){return this._name},getScheme:function(){return this._scheme}},e.exports=t},function(e,t,n){var a=n(12),r=n(4),o=function(){this._callbacks=[];var e=this;a.on('load',window,function(){setTimeout(function(){a.on('popstate',window,function(){return e._index=window.history.state?window.history.state.index:-1,!(-1===e._index&&e._loadEntry(e._index))&&void 0===r(window.location.href,!1)&&void window.location.replace(window.location.href)})},1)})};o.prototype={_index:-1,_callbacks:null,_updateUrl:function(e){window.history.pushState({index:this.index},'',e)},_loadEntry:function(e){return!!this._callbacks[e]&&(this._callbacks[e](),!0)},addEntry:function(e,t){window.history.pushState&&(this._index++,this._callbacks.length-1>this._index&&this._callbacks.splice(this._index,this._callbacks.length-this._index),this._callbacks[this._index]=t,this._updateUrl(e))}},e.exports=new o},function(e,t,n){var a=n(9),r=n(0),o=n(21),i=n(3),l=n(1),s=function(e){return this._buildConfig(e),this};s.prototype={_root:null,_template:null,_templateUrl:null,_context:null,_onMounted:null,_onRender:null,_onRendered:null,_onUpdate:null,_onUpdated:null,_onRevoke:null,_onRevoked:null,_fusioner:null,_rendered:!1,_buildConfig:function(e){for(var t in e)null===this['_'+t]?this['_'+t]='context'===t?this._buildContext(e[t]):e[t]:this[t]=e[t];if(!this._root)throw new Error('Root must be defined to construct a view.');this._context||(this._context=this._buildContext({}))},_buildContext:function(e){var t,n={};for(t in e)!1==e[t]instanceof i&&(n[t]=e[t],delete e[t]);for(t in n=new i(n),e)n[t]=e[t];return n.generateUrl=function(e,t,n){return l.generateUrl(e,t,n)},n},_getRoot:function(){if('string'==typeof this._root){var e=r.first(this._root);if(!e)throw new Error('Root element with selector "'+this._root+'" could not been found.');this._root=e}return this._root},render:function(){var e=this;if(!this._template&&this._templateUrl?a.get(this._templateUrl,{t_ref:new Date().getTime()},{async:!1,success:function(t){e._template=t},error:function(){throw new Error('Template located in "'+e._templateUrl+'" could not be loaded.')}}):!this._template&&!this._templateUrl&&(this._template=[this._getRoot()]),'string'==typeof this._template){this._template=r.createElement(this._template);var t=[];if(this._template instanceof HTMLElement)t.push(this._template);else if(this._template instanceof DocumentFragment)for(;this._template.firstChild;)t.push(this._template.removeChild(this._template.firstChild));this._template=t}if(!this._fusioner){var n={element:this._template,context:this._context,shouldApply:function(){return e._rendered}};'function'==typeof e._onUpdate&&(n.onUpdate=function(){e._onUpdate()}),'function'==typeof e._onUpdated&&(n.onUpdated=function(){e._onUpdated()}),this._fusioner=new o(n)}if(!this._rendered){'function'==typeof this._onRender&&this._onRender();var i=this._getRoot();this._template[0]===i?r.putBackElement(i):r.insertElements(this._template,i),this._rendered=!0,'function'==typeof this._onRendered&&this._onRendered(),this._fusioner.applyChanges()}},revoke:function(){if(this._rendered){'function'==typeof this._onRevoke&&this._onRevoke();var e=this._getRoot();if(this._template[0]!==e)for(var t=0,n=this._template.length;t<n;++t)r.removeElement(this._template[t]);else r.putAsideElement(e);this._rendered=!1,'function'==typeof this._onRevoked&&this._onRevoked()}},getContext:function(){return this._context}},e.exports=s},function(e,t,n){var a=n(2),r=n(0),o=n(7),l=n(22),s=n(3),d=n(10),i=function(e){this._init=[],this._waiting=[],this._events={},!1==e.element instanceof Array&&(e.element=[e.element]),this._element=e.element,this._context=e.context,this._shouldApply=e.shouldApply,this._onUpdate=e.onUpdate,this._onUpdated=e.onUpdated;for(var t=0,n=this._element.length;t<n;++t)this._bind(this._element[t]);return this};i.prototype={_element:null,_context:null,_shouldApply:null,_init:null,_waiting:null,_events:null,_extractMarkers:function(e){if(e){var t=/\{\{((?!\{\{|\}\}).)*\}\}/g,n=/\{\{|\}\}/g,a=e.match(t);if(a&&0<a.length)return a=a.map(function(e){return{outer:e,inner:e.replace(n,'').trim()}}),0<a.length?a:[]}return[]},_extractContextProperties:function(e){for(var t,n,a=[],r=e.split(/[ |(|)|{|}|[|]|,|:|\+|"|']/g),o=0,i=r.length;o<i;++o)t=r[o].split('.'),n=t.shift(),void 0!==this._context[n]&&(!1==this._context[n]instanceof s&&(t.unshift(n),n=null),a.push({model:n,path:t.join('.').replace('.length','')}));return a},_replaceAliases:function(e,t){if(t)for(var n in t)if(n===e)e=t[n];else{e=e.replace(new RegExp('([(|)|,|+|-|*|/])?(\\b'+n+'\\b)+([(|)|,|+|-|*|/])?','g'),function(e,a,r,o){return(a?a:'')+t[n]+(o?o:'')})}return e},_replaceAliasesInElement:function(e,t){var n,a;if(1===e.nodeType){if(e.getAttribute('data-no-bind'))return;if(e.attributes)for(n=0,a=e.attributes.length;n<a;++n)e.setAttribute(e.attributes[n].name,this._replaceAliases(e.attributes[n].value,t))}else if(3===e.nodeType){var r=e.textContent?'textContent':'nodeValue';e[r]=this._replaceAliases(e[r],t)}if(e.childNodes&&0<e.childNodes.length)for(n=0,a=e.childNodes.length;n<a;++n)this._replaceAliasesInElement(e.childNodes[n],t);return e},_evaluateText:function(e){var t=l.process(e,this._context);return t||0===t?t:''},_getPropPath:function(e){return(e.model?e.model+'.':'')+e.path},_on:function(e,t,n){var r=this._getPropPath(t),o=r+':'+e;if(!this._events[o]){this._events[o]=[];var i=t.model?this._context[t.model]:this._context,l=this;i.on(e,t.path,function(n){l._dispatch(e,t,n)}),a.getPropertyValue(this._context,r)instanceof d&&(i.on('add',t.path,function(n){l._dispatch(e,t,n)}),i.on('remove',t.path,function(n){l._dispatch(e,t,n)}))}this._events[o].push(n)},_trigger:function(e,t,n){var a=t.model?this._context[t.model]:this._context;a.trigger(e,t.path,n)},_dispatch:function(e,t,n){var a=this._getPropPath(t)+':'+e;if(0<this._events[a].length){var r,o;if(!1!==this._shouldApply()){for('function'==typeof this._onUpdate&&this._onUpdate(),r=0,o=this._events[a].length;r<o;++r)this._events[a][r](n);'function'==typeof this._onUpdated&&this._onUpdated()}else for(r=0,o=this._events[a].length;r<o;++r)this._waiting.push(this._events[a][r])}},_bind:function(t,e){if(t){var n,s,p,c,_,i,u,h,m,g=this;if(1===t.nodeType){if(t.getAttribute('data-no-bind'))return;if(n=t.getAttribute('data-for')){e=e||{};var f=n.replace(/in .*/,'').trim(),v=null;-1!==f.indexOf(',')&&(f=f.split(','),v=f[0].trim(),f=f[1].trim());var x=n.replace(/.* in/,'').trim(),y=this._extractContextProperties(x,e),b=t.parentNode,P=r.getPosition(t);r.removeElement(t),t.removeAttribute('data-for');var E=l.process(x,this._context);if(void 0===E)throw new Error(x+' is an invalid expression for a loop.');var T=[];if(E instanceof d){s=y[0],p=this._getPropPath(s);var k=[],N=function(n){n=n||a.getPropertyValue(g._context,p);var o,i,l,s,d,c,_=[],u=[],h=[],m=[];for(o=0,l=n.length;o<l;++o)k[o]!==n[o]&&(k[o]?h.push(o):(d=t.cloneNode(!0),_.push(d),u.push(o),T.push(d)));if(k.length>n.length)for(o=k.length-1,l=n.length-1;o>l;--o)r.removeElement(T[o]),T.splice(o,1),m.push(o);else for(r.insertElements(_,b,P+(T.length-_.length)),o=0,l=u.length;o<l;++o)e[f]=p+'.'+u[o],v&&(e[v]=u[o]+''),g._bind(g._replaceAliasesInElement(T[u[o]],e),e);if(h.length||m.length){var x=h.length?new RegExp('^'+p+'\\.(?:'+h.join('|')+')\\.'):null,y=m.length?new RegExp('^'+p+'\\.(?:'+m.join('|')+')\\.'):null;for(c in g._events)if(y&&y.test(c)&&(g._events[c]=[]),x&&x.test(c))for(i=0,s=g._events[c].length;i<s;++i)g._events[c][i]()}k=n.slice(0)};this._on('change',s,function(){N()}),N(E)}else if(E instanceof Object){var w=[];for(var C in E)E.hasOwnProperty(C)&&'function'!=typeof E[C]&&(w.push(C),T.push(t.cloneNode(!0)));for(r.insertElements(T,b,P),_=0,i=T.length;_<i;++_)v?(e[v]='"'+w[_]+'"',e[f]=x+'.'+w[_]):e[f]='"'+w[_]+'"',g._bind(g._replaceAliasesInElement(T[_],e),e)}else if('number'==typeof E){var U=0,A=function(n){if(n=n||l.process(x,g._context),n!==U){var a,o,i,s=[];if(n>U){for(a=U;a<n;++a)i=t.cloneNode(!0),s.push(i),T.push(i);for(r.insertElements(s,b,P),a=0,o=s.length;a<o;++a)e[f]=U+a+'',g._bind(g._replaceAliasesInElement(s[a],e),e)}else for(a=U;a>=n;--a)r.removeElement(T[a]),T.splice(a,1);U=n}};if(0<y.length)for(_=0,i=y.length;_<i;++_)this._on('change',y[_],function(){A()});A(E)}return}if(n=t.getAttribute('data-bind')){if(s=this._extractContextProperties(n),0===s.length)throw new Error('Data-bind with value "'+n+'" refers to a non existing context property.');s=s[0],p=this._getPropPath(s);var O,S=t.tagName.toLowerCase();'select'===S||'input'===S&&('radio'===t.type||'checkbox'===t.type)?(O=function(e){e=e||a.getPropertyValue(g._context,p),'radio'===t.type||'checkbox'===t.type?!0===e||e===t.value?t.checked='checked':t.checked='':t.value=e},g._init.push(function(){O(a.getPropertyValue(g._context,p))}),this._on('change',s,O),o.on('change',t,function(n){var e=n.target||n.srcElement,a=e.value;('radio'===t.type||'checkbox'===t.type)&&('checkbox'===e.type&&'on'===a?a=!!e.checked:a=e.checked?a:null),g._trigger('change',s,a)})):('textarea'===S||'input'===S)&&(O=function(e){e=e||a.getPropertyValue(g._context,p),t.value=e||''},O(a.getPropertyValue(this._context,p)),this._on('change',s,O),c='oninput'in t?'input':'keyup, keypress',o.on(c,t,function(t){var e=t.target||t.srcElement;g._trigger('change',s,e.value)}))}if(n=t.getAttribute('data-events')){var R,M,V=n.split(';');for(_=0,i=V.length;_<i;++_)R=V[_].split(':'),2===R.length&&(c=R[0].trim(),M=R[1].trim(),o.on(c,t,function(t){g._context.e=t,l.process(M,g._context)}));t.removeAttribute('data-events')}if((n=t.getAttribute('data-if'))&&(function(e){var n=function(){var n=l.process(e,g._context);void 0===n||!1===n||null===n||''===n?r.putAsideElement(t):r.putBackElement(t)};t.parentNode?n():g._init.push(n),g._extractContextProperties(e).forEach(function(e){'function'!=typeof a.getPropertyValue(g._context,g._getPropPath(e))&&g._on('change',e,n)})}(n),t.removeAttribute('data-if')),(n=t.getAttribute('data-show'))&&(function(e){var n=function(){var n=l.process(e,g._context);t.style.display=void 0===n||!1===n||null===n||''===n?'none':''};n(),g._extractContextProperties(e).forEach(function(e){'function'!=typeof a.getPropertyValue(g._context,g._getPropPath(e))&&g._on('change',e,n)})}(n),t.removeAttribute('data-show')),t.attributes)for(_=0,i=t.attributes.length;_<i;++_)u=t.attributes[_].name,h=t.attributes[_].value,h&&(m=g._extractMarkers(h),0<m.length&&function(e,n,r){var o=function(){for(var a=n,o=0,i=r.length;o<i;++o)a=a.replace(r[o].outer,g._evaluateText(r[o].inner));t.setAttribute(e,a)};o(),r.forEach(function(e){g._extractContextProperties(e.inner).forEach(function(e){'function'!=typeof a.getPropertyValue(g._context,g._getPropPath(e))&&g._on('change',e,o)})})}(u,h,m))}else if(3===t.nodeType){var L=t.textContent?'textContent':'nodeValue';if(h=t[L].trim(),h&&(m=this._extractMarkers(h),0<m.length)){var G=function(){for(var e=h,n=0,a=m.length;n<a;++n)e=e.replace(m[n].outer,g._evaluateText(m[n].inner));t[L]=e};for(G(),_=0,i=m.length;_<i;++_)this._extractContextProperties(m[_].inner).forEach(function(e){'function'!=typeof a.getPropertyValue(g._context,g._getPropPath(e))&&g._on('change',e,G)})}}if(t.childNodes&&0<t.childNodes.length)for(_=0,i=t.childNodes.length;_<i;++_)this._bind(t.childNodes[_],e);return t}},applyChanges:function(){var e,t;if(0<this._init.length){for(e=0,t=this._init.length;e<t;++e)this._init[e]();this._init=[]}if(0<this._waiting.length){for('function'==typeof this._onUpdate&&this._onUpdate(),e=0,t=this._waiting.length;e<t;++e)this._waiting[e]();this._waiting=[],'function'==typeof this._onUpdated&&this._onUpdated()}}},e.exports=i},function(e){e.exports=new function(){'use strict';var e,t,n,a,r,o,l,s,d,p,c,_,i=',',u={"!":function(e,t){return!t[e+1]},"*":function(e,t){return t[e-1]*t[e+1]},"/":function(e,t){return t[e-1]/t[e+1]},"%":function(e,t){return t[e-1]%t[e+1]},"-":function(e,t){return(t[e-1]||0)-t[e+1]},"+":function(e,t){var n=void 0===t[e-1]?0:t[e-1];null===n&&(n='');var a=void 0===t[e+1]?0:t[e+1];return null===a&&(a=''),n+a},"!=":function(e,t){return t[e-1]!==t[e+1]},"==":function(e,t){return t[e-1]===t[e+1]},">":function(e,t){return t[e-1]>t[e+1]},">=":function(e,t){return t[e-1]>=t[e+1]},"<":function(e,t){return t[e-1]<t[e+1]},"<=":function(e,t){return t[e-1]<=t[e+1]},"&&":function(e,t){return t[e-1]&&t[e+1]},"||":function(e,t){return t[e-1]||t[e+1]},"?":function(e,t){var n=':'===t[e+1]?'':t[e+1],a=void 0===t[e+3]?':'===t[e+2]?'':t[e+2]:t[e+3];return t[e-1]?n:a}};this.process=function(h,m){function g(e){return!0!==e}function f(e){_.push(e)}function v(){return _.pop()}function x(){return n||a}function y(e){return /^[a-z.]+\(/i.test(e)}function b(e){return void 0!==u[e]}function P(n){p&&(e++,t[e]='',p=!1),t[e]+=n}function E(e){T(),P(e)}function T(){''!==t[e]&&(p=!0),!0===c&&(t[e]=w(t[e]),c=!1)}function N(e,t){var n=e.split('.');if(m&&void 0!==m[n[0]]){var a,r=m,o=r,i=n.length;for(a=0;a<i;++a)if(void 0!==r[n[a]])o=r,r=r[n[a]];else return;return'function'==typeof r&&(r=r.apply(o,t)),r}}function w(e){return'undefined'===e?void 0:'null'===e?null:'false'!=e&&('true'==e||(isNaN(e)?N(e):parseFloat(e)))}function C(n,a){t.splice(a,1);var r=t[n].substring(0,t[n].length-1),o=t.splice(n+1,a);O(o);var l=o.filter(function(e){return e!==i});t[n]=N(r,l),e=n}function U(n,a){var r=t.splice(n+1,a-n-1);O(r),t.splice(n,2,r[0]),e=n}function A(n,a){for(var r=n;r<a;++r)'{'!==t[r]&&':'!==t[r]&&'}'!==t[r]&&','!==t[r]&&'['!==t[r]&&']'!==t[r]&&(isNaN(parseFloat(t[r]))||!isFinite(t[r]))&&(t[r]='"'+t[r]+'"');var o=t.splice(n,a-n+1),i=JSON.parse(o.join(''));t[n]=i,e=n}function O(n){n=n||t;var a,r,o,i,l;for(i in u)if(void 0!==d[i])for(;-1<(l=n.indexOf(i));)'?'===i?(a=l-1,r=5):'!'===i?(a=l,r=2):(a=0<=l-1?l-1:l,r=e===a?2:3),o=u[i](l,n),n.splice(a,r,o)}e=0,t=[''],n=!1,a=!1,r=!1,o=!1,l=0,s=0,d={},p=!1,c=!1,_=[];var S,R,k=h.length;for(S=0;S<k;++S)switch(R=h[S],R){case'"':if(!n&&!r){a=g(a),(!a||o)&&T();continue}c=!1,P(R);break;case'\'':if(!a&&!r){n=g(n),(!n||o)&&T();continue}c=!1,P(R);break;case'\\':if(r=g(r),r)continue;P(R);break;default:if(x())P(R);else switch(R){case' ':T();break;case i:case':':E(R),T();break;case'[':E(R),T(),0===s+l&&f(e),++s;break;case']':E(R),T(),--s,0===s+l&&A(v(),e);break;case'{':E(R),T(),0===s+l&&f(e),++l;break;case'}':E(R),T(),--l,0===s+l&&A(v(),e);break;case'(':y(t[e]+R)?c=!1:T(),P(R),T(),f(e);break;case')':E(R),T();var M=v();y(t[M])?C(M,e):U(M,e);break;default:b(t[e]+R)?(o=!0,c=!1,d[t[e]+R]=!0):b(R)?(!o&&T(),o=!0,c=!1,d[R]=!0):o?(T(),o=!1,c=!0,d[t[e]]=!0):c=!0,P(R);}}if(c&&(t[e]=w(t[e])),O(t),1<t.length)throw new Error('Invalid expression "'+h+'".');return t[0]}}},function(e,t,n){var r=n(0),a=function(e){return this._components={},this._query={},this._post={},this._build(e)};a.prototype={_event:null,_protocol:null,_host:null,_port:null,_path:null,_url:null,_method:null,_hash:null,_components:null,_query:null,_post:null,_build:function(e){this._event=e.event;var t=document.createElement('a');return t.href=e.event.target.action||e.event.target.href,this._protocol=t.protocol.replace(':',''),this._host=t.hostname,this._port=parseInt(e.port),isNaN(this._port)&&(this._port=parseInt(window.location.port.replace(':')),isNaN(this._port)&&(this._port='https:'===window.location.protocol?443:80)),this._path=t.pathname.replace('//','/'),this._url=t.href,this._method=(e.event.target.method||'GET').toUpperCase(),this._hash=t.hash,e.route&&(this._components=e.route.extractParamsFromUrl(t.href)),t.search&&(this._query=JSON.parse('{"'+decodeURI(t.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')),'FORM'===e.event.target.tagName.toUpperCase()&&'POST'===this._method&&(this._post=r.formToObject(e.event.target)),this},getEvent:function(){return this._event},getProtocol:function(){return this._protocol},getHost:function(){return this._host},getPath:function(){return this._path},getUrl:function(){return this._url},getPort:function(){return this._port},getMethod:function(){return this._method},getHash:function(){return this._hash},getUriComponents:function(){return this._components},getQueryParams:function(){return this._query},getPostParams:function(){return this._post}},e.exports=a}]);